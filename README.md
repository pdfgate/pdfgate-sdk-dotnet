# PdfGate.net

[![NuGet](https://img.shields.io/nuget/v/pdfgate.net.svg)](https://www.nuget.org/packages/PdfGate.net/)

The official [PDFGate](https://pdfgate.com/) official .NET SDK supporting .NET Standard 2.0+.

## Installation

Using the [.NET Core command-line interface (CLI) tools][dotnet-core-cli-tools]:

```sh
dotnet add package PdfGate.net
```

Using the [NuGet Command Line Interface (CLI)][nuget-cli]:

```sh
nuget install PdfGate.net
```

Using the [Package Manager Console][package-manager-console]:

```powershell
Install-Package PdfGate.net
```

From within Visual Studio:

1. Open the Solution Explorer.
2. Right-click on a project within your solution.
3. Click on _Manage NuGet Packages..._
4. Click on the _Browse_ tab and search for "PdfGate.net".
5. Click on the PdfGate.net package, select the appropriate version in the
   right-tab and click _Install_.

## Requirements

We currently support .NET Standard 2.0+, which means the minimum requirements are:

- .NET Framework 4.6.1+
- .NET Core 2.0+ (includes 3.1, 5, 6, 7, 8)
- Mono 5.4+
- Xamarin (iOS/Android)
- Universal Windows Platform (UWP) 10.0.16299+

## Documentation

You can find the full HTTP API documentation [here][api-docs] and there's code documentation in the SDK.

## Usage

First, you will always need a client to interact with the API:

```csharp
using System.Text.Json;
using PdfGate.net;
using PdfGate.net.Models;

internal static class Program
{
    private static void Main()
    {
        var apiKey = "test_your_api_key_here";

        using var client = new PdfGate(apiKey);

        // client is ready to call API methods, e.g. client.GeneratePdf(...)
    }
}
```

Then, the two main usage patterns are:

### PDF Generation

Generate a new PDF from an HTML:

```csharp
var request = new GeneratePdfRequest 
{
    Html = 
        "<html><body><h1>Acceptance Test</h1><p>Generated by SDK acceptance test.</p></body></html>"
};

var generatedDoc = await client.GeneratePdfAsync(request, CancellationToken.None);
```

or a URL:

```csharp
GeneratePdfRequest request = new GeneratePdfRequest 
{
    Url = 
        "https://example.com/pdf-gate.pdf"
};

var generatedDoc = await client.GeneratePdfAsync(request, CancellationToken.None);
```

and then download it with `GetFile`:

```csharp
var getFileRequest = new GetFileRequest { DocumentId = generatedDoc.Id };

Stream fileResponse = await client.GetFileAsync(getFileRequest, CancellationToken.None);
```

### PDF Transformation

First, you will need to upload the file you want to transform. You can do this by generating
a file from HTML or an URL as shown above, or you can upload a PDF file directly via `UploadFileAsync`:

```csharp
using Stream fileToUpload = File.OpenRead("input.pdf");
var request = new UploadFileRequest { Content = fileToUpload };

PdfGateDocumentResponse uploadedResponse = await client.UploadFileAsync(request, CancellationToken.None);
```

Once you have a Document ID, you can transform it with any of the following operations:

**Flatten PDF**

```csharp
var flattenRequest = new FlattenPdfRequest
{
    DocumentId = uploadedResponse.Id
};

PdfGateDocumentResponse flattenedDoc = await client.FlattenPdfAsync(
    flattenRequest,
    CancellationToken.None);
```

**Watermark PDF**

```csharp
var watermarkRequest = new WatermarkPdfRequest
{
    DocumentId = uploadedResponse.Id,
    Type = WatermarkPdfType.Text,
    Text = "CONFIDENTIAL",
    Font = WatermarkPdfFont.HelveticaBold,
    FontColor = "#9C32A8",
    FontSize = 30,
    Rotate = 30,
    Opacity = 0.2
};

PdfGateDocumentResponse watermarkedDoc = await client.WatermarkPdfAsync(
    watermarkRequest,
    CancellationToken.None);
```

**Protect a PDF**

```csharp
var protectRequest = new ProtectPdfRequest
{
    DocumentId = uploadedResponse.Id,
    Algorithm = ProtectPdfEncryptionAlgorithm.Aes256,
    UserPassword = "user-password",
    OwnerPassword = "owner-password",
    DisablePrint = true,
    DisableCopy = true,
    DisableEditing = true
};

PdfGateDocumentResponse protectedDoc = await client.ProtectPdfAsync(
    protectRequest,
    CancellationToken.None);
```

**Compress a PDF**

```csharp
var compressRequest = new CompressPdfRequest
{
    DocumentId = uploadedResponse.Id,
    Linearize = true
};

PdfGateDocumentResponse compressedDoc = await client.CompressPdfAsync(
    compressRequest,
    CancellationToken.None);
```

All of these operations will return a new Document ID that points to the document
that resulted from this transformation. You can then download it with `GetFileAsync`:


```csharp
var getFileRequest = new GetFileRequest { DocumentId = transformedDoc.Id };

Stream fileResponse = await client.GetFileAsync(getFileRequest, CancellationToken.None);
```
 
### PDF Data Extraction

The `ExtractPdfFormData` method lets you read data from a fillable PDF.
It extracts all form fields in the document along with their current values
and returns them as a JSON object.

```csharp
var extractRequest = new ExtractPdfFormDataRequest
{
    DocumentId = uploadedResponse.Id
};

JsonElement formData = await client.ExtractPdfFormDataAsync(
    extractRequest,
    CancellationToken.None);
```

### PDF Sharing

In the case that you don't need the actual resulting PDF file, you just need to a way for other clients
or users to access it, you can do so by requesting on any method that the response includes a pre-signed URL:

```csharp
var generateRequest = new GeneratePdfRequest
{
    Url = "https://example.com/invoice",
    PreSignedUrlExpiresIn = 3600
};

PdfGateDocumentResponse generatedWithUrl = await client.GeneratePdfAsync(
    generateRequest,
    CancellationToken.None);

string? shareableFileUrl = generatedWithUrl.FileUrl;
```

You can also request a refreshed pre-signed URL for an existing document:

```csharp
var getDocumentRequest = new GetDocumentRequest
{
    DocumentId = generatedWithUrl.Id,
    PreSignedUrlExpiresIn = 3600
};

PdfGateDocumentResponse documentWithRefreshedUrl = await client.GetDocumentAsync(
    getDocumentRequest,
    CancellationToken.None);
```



[dotnet-core-cli-tools]: https://docs.microsoft.com/en-us/dotnet/core/tools/
[nuget-cli]: https://docs.microsoft.com/en-us/nuget/tools/nuget-exe-cli-reference
[package-manager-console]: https://docs.microsoft.com/en-us/nuget/tools/package-manager-console
[api-docs]: https://pdfgate.com/documentation
